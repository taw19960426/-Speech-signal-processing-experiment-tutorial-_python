## 1 åŸºéŸ³é¢‘ç‡

### 1.1 åŸºéŸ³é¢‘ç‡çš„æŸ¥çœ‹

åŸºéŸ³é¢‘ç‡å°±æ˜¯å‘æµŠéŸ³æ—¶ï¼Œæ°”æµé€šè¿‡å£°é—¨ä½¿å£°å¸¦äº§ç”Ÿå¼ å¼›éœ‡è¡å¼æŒ¯åŠ¨ï¼Œäº§ç”Ÿå‡†å‘¨æœŸçš„æ¿€åŠ±è„‰å†²ä¸²ã€‚è¿™ç§å£°å¸¦æŒ¯åŠ¨çš„é¢‘ç‡ç§°ä¸ºåŸºéŸ³é¢‘ç‡ã€‚

é€šè¿‡è½¯ä»¶Auditionå°±å¯ä»¥æŸ¥çœ‹åŸºéŸ³é¢‘ç‡ï¼Œè¯­è°±å›¾æœ€åä¸€æ¡å£°çº¹å¯¹åº”çš„é¢‘ç‡å°±æ˜¯åŸºéŸ³é¢‘ç‡ã€‚ä¸‹å›¾ä¸ºå¥³æ€§å…ƒéŸ³â€™aâ€˜çš„å‘éŸ³ï¼Œè¯­éŸ³åŸºæœ¬ä¿¡æ¯ä¸ºï¼šé‡‡æ ·ç‡8000Hzï¼Œå•å£°é“ï¼Œ16ä½ã€‚

![1](VowelStuday.assets/1-1606397405309.png)

é€šè¿‡è½¯ä»¶Auditionå¯ä»¥ç›´æ¥æŸ¥çœ‹å‡ºç”·æ€§å’Œå¥³æ€§çš„åŸºéŸ³é¢‘ç‡ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š

- ç”·æ€§è¯´è¯äººçš„åŸºéŸ³é¢‘ç‡åœ¨50-200Hz
- å¥³æ€§è¯´è¯äººçš„åŸºéŸ³é¢‘ç‡åœ¨200-450Hz

## 2 å…±æŒ¯å³°çš„è·å–

### 2.1 å€’è°±æ³•æ±‚å…±æŒ¯å³°

æµç¨‹å¦‚ä¸‹ï¼š

```mermaid
graph LR
A[é¢„å¤„ç†] -->B[FFT]
    B --> C[å¯¹æ•°å¹…å€¼è°±]
    C --> D[IFFT]
    D --> E[çª—å‡½æ•°]
    E --> F[FFT]
```

å…·ä½“æ­¥éª¤ï¼š

å€’è°±æ³•å…±æŒ¯å³°ä¼°è®¡çš„ç®—æ³•è¿‡ç¨‹ä¸ºï¼š

 - å¯¹è¯­éŸ³ä¿¡å·$x$è¿›è¡Œé¢„åŠ é‡ï¼Œå¹¶è¿›è¡ŒåŠ çª—ï¼ŒFFTå¤„ç†
   $$
   X(k)=\sum_{n=1}^Nx(n)e^{-\frac{2\pi kn j}{N}} \tag{2-1}
   $$
   çª—å‡½æ•°ä¸ºæ±‰æ˜çª—ï¼Œé•¿åº¦ä¸º320ã€‚å£°éŸ³é‡‡æ ·é¢‘ç‡ä¸º8000Hzï¼ŒFFTé•¿åº¦é»˜è®¤ä¸º65536ã€‚

 - å–$X(k)$çš„å€’è°±ï¼š
   $$
   \hat x(n)=\frac{1}{N}\sum_{k=1}^N\lg|X(k)|e^{-\frac{2\pi kn j}{N}} \tag{2-2}
   $$
   
 - ç»™å€’è°±ä¿¡å·åŠ çª—å¾—ï¼š$h(n)=\hat x(n)\times h(n)$,è¿™é‡Œçš„çª—å‡½æ•°å’Œå€’è°±çš„åˆ†è¾¨ç‡æœ‰å…³ï¼ˆå’Œé‡‡æ ·ç‡å’ŒFFTé•¿åº¦æœ‰å…³ï¼‰ï¼š
   $$
   h(n)=\left \{\begin{array}{lc}
    1&n\leqslant n_0-1 \&n\geqslant N-n_0+1\\
    0& n_0-1<n<N-n_0+1
     \end{array}\right.,n\in[0,N-1] \tag{2-3}
   $$
   å¼ä¸­$n_0$æ˜¯çª—å‡½æ•°çš„å®½åº¦

 - æ±‚åŒ…ç»œçº¿

 - åœ¨åŒ…ç»œçº¿ä¸Šå¯»æ‰¾æå¤§å€¼ï¼Œè·å¾—ç›¸åº”å…±æŒ¯å³°å‚æ•°ã€‚

å®ç°ä»£ç ä¸ºï¼š

```python
def Formant_Cepst(u, cepstL):
    """
    å€’è°±æ³•å…±æŒ¯å³°ä¼°è®¡å‡½æ•°
    :param u:è¾“å…¥ä¿¡å·
    :param cepstL:ğŸ”ªé¢‘ç‡ä¸Šçª—å‡½æ•°çš„å®½åº¦
    :return: valå…±æŒ¯å³°å¹…å€¼ 
    :return: locå…±æŒ¯å³°ä½ç½® 
    :return: specåŒ…ç»œçº¿
    """
    wlen2 = len(u) // 2
    u_fft=np.fft.fft(u)                         #æŒ‰å¼ï¼ˆ2-1ï¼‰è®¡ç®—
    U = np.log(np.abs( u_fft[:wlen2]))
    Cepst = np.fft.ifft(U)                      #æŒ‰å¼ï¼ˆ2-2ï¼‰è®¡ç®—
    cepst = np.zeros(wlen2, dtype=np.complex)
    cepst[:cepstL] = Cepst[:cepstL]             #æŒ‰å¼ï¼ˆ2-3ï¼‰è®¡ç®—
    cepst[-cepstL + 1:] = Cepst[-cepstL + 1:]	#å–ç¬¬äºŒä¸ªå¼å­çš„ç›¸å 
    spec = np.real(np.fft.fft(cepst))
    val, loc = local_maxium(spec)               #åœ¨åŒ…ç»œçº¿ä¸Šå¯»æ‰¾æå¤§å€¼
    return val, loc, spec
```

### 2.2 æµ‹è¯•ç»“æœ

ä½é€šçª—å‡½æ•°$n_0=7$ã€‚æµ‹è¯•ç”·æ€§a1ç”»å‡ºæ³¢å½¢å¦‚å›¾æ‰€ç¤ºï¼š

![å…±æŒ¯å³°ä¼°è®¡](VowelStuday.assets/å…±æŒ¯å³°ä¼°è®¡.png)

äº”å…ƒéŸ³çš„å‰ä¸¤å…±æŒ¯å³°çš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š

| å…ƒéŸ³  | ç¬¬ä¸€å…±æŒ¯å³° | ç¬¬äºŒå…±æŒ¯å³° |
| :---: | :--------: | :--------: |
| a1/a2 | 1021/1044  | 2428/2404  |
| o1/o2 |  596/522   | 1583/1673  |
| e1/e2 |  469/408   |  996/1018  |
| i1/i2 |  372/375   | 1149/1031  |
| u1/u2 |  508/514   | 1543/3494  |

2.3 å®ç°ç¨‹åº

CepstrumFormant.py

```python
from å…±æŒ¯å³°ä¼°è®¡å‡½æ•° import *
from scipy.signal import lfilter
import librosa
import numpy as np
import matplotlib.pyplot as plt

plt.figure(figsize=(14, 12))
path="F:\\python\\VowelStuday\\SingleVowel\\aoeiuå…ƒéŸ³éŸ³é¢‘\\åŸå§‹å…ƒéŸ³ç”·æ€§\\a1.wav"
#path="C4_3_y.wav"
#data, fs = soundBase('C4_3_y.wav').audioread()
data, fs = librosa.load(path, sr=None, mono=False)#sr=Noneå£°éŸ³ä¿æŒåŸé‡‡æ ·é¢‘ç‡ï¼Œ mono=Falseå£°éŸ³ä¿æŒåŸé€šé“æ•°
# é¢„å¤„ç†-é¢„åŠ é‡
u = lfilter([1, -0.99], [1], data)

cepstL = 7
wlen = len(u)
wlen2 = wlen // 2
print("å¸§é•¿={}".format(wlen))
print("å¸§ç§»={}".format(wlen2))
# wlen = 256
# wlen2 = 256//2
# é¢„å¤„ç†-åŠ çª—
u2 = np.multiply(u, np.hamming(wlen))
# é¢„å¤„ç†-FFT,å–å¯¹æ•° è·å¾—é¢‘åŸŸå›¾åƒ å–ä¸€åŠ
U_abs = np.log(np.abs(np.fft.fft(u2))[:wlen2])
# 4.3.1
freq = [i * fs / wlen for i in range(wlen2)]
#print(freq)
#valå…±æŒ¯å³°å¹…å€¼ locå…±æŒ¯å³°ä½ç½® specåŒ…ç»œçº¿
val, loc, spec = Formant_Cepst(u, cepstL)
plt.subplot(2, 1, 1)
plt.plot(freq, U_abs, 'k')
plt.xlabel('é¢‘ç‡/Hz')           #è®¾ç½®xï¼Œyè½´çš„æ ‡ç­¾
plt.ylabel('å¹…å€¼')
plt.title('ç”·æ€§açš„å‘éŸ³é¢‘è°±')
plt.subplot(2, 1, 2)
plt.plot(freq, spec, 'k')
plt.xlabel('é¢‘ç‡/Hz')           #è®¾ç½®xï¼Œyè½´çš„æ ‡ç­¾
plt.ylabel('å¹…å€¼')
plt.title('å€’è°±æ³•å…±æŒ¯å³°ä¼°è®¡')
for i in range(len(loc)):
    plt.subplot(2, 1, 2)
    plt.plot([freq[loc[i]], freq[loc[i]]], [np.min(spec), spec[loc[i]]], '-.k')
    plt.text(freq[loc[i]], spec[loc[i]], 'Freq={}'.format(int(freq[loc[i]])))

plt.savefig('images/å…±æŒ¯å³°ä¼°è®¡.png')
plt.show()
plt.close()
```

### 2.3 å…±æŒ¯å³°ä½ç½®åæ ‡

ä»¥å…ƒéŸ³çš„ç¬¬ä¸€å…±æŒ¯å³°é¢‘ç‡ä¸ºxè½´ï¼Œç¬¬äºŒå…±æŒ¯å³°é¢‘ç‡ä¸ºyè½´ï¼Œå°†äº”ä¸ªå…ƒéŸ³çš„å‰ä¸¤ä¸ªå…±æŒ¯å³°ç”»åœ¨ä¸€ä¸ªäºŒç»´ç©ºé—´ä¸­ã€‚äº”ä¸ªå…ƒéŸ³æ˜¯åŒä¸€ä¸ªäººçš„å‘éŸ³ã€‚

![äº”å…ƒéŸ³å…±æŒ¯å³°](VowelStuday.assets/äº”å…ƒéŸ³å…±æŒ¯å³°.png)

### 2.4 å¤šç§æƒ…å†µä¸‹çš„å…±æŒ¯å³°æµ‹è¯•

å¯¹äºåŒä¸€ä¸ªå…ƒéŸ³ï¼Œä¸åŒæ€§åˆ«çš„å‘å£°äººåœ¨ç¬¬1å…±æŒ¯å³°é¢‘ç‡å’Œç¬¬2å…±æŒ¯å³°é¢‘ç‡çš„ä¸¤å…±æŒ¯å³°çš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š

| å…ƒéŸ³      | ç¬¬ä¸€å…±æŒ¯å³° | ç¬¬äºŒå…±æŒ¯å³° |
| :-------- | :--------: | :--------: |
| ç”·æ€§aå‘éŸ³ |    1021    |    2428    |
| å¥³æ€§aå‘éŸ³ |    1145    |    2364    |
| ç”·æ€§eå‘éŸ³ |    469     |    996     |
| å¥³æ€§eå‘éŸ³ |    500     |    1118    |
| ç”·æ€§iå‘éŸ³ |    372     |    1149    |
| å¥³æ€§iå‘éŸ³ |    379     |    1106    |
| ç”·æ€§oå‘éŸ³ |    596     |    1583    |
| å¥³æ€§oå‘éŸ³ |    617     |    1663    |
| ç”·æ€§uå‘éŸ³ |    508     |    1543    |
| å¥³æ€§uå‘éŸ³ |    437     |    2426    |

å¯¹äºåŒä¸€ä¸ªå…ƒéŸ³ï¼Œä¸åŒæ€§åˆ«çš„å‘å£°äººåœ¨ç¬¬1å…±æŒ¯å³°é¢‘ç‡å’Œç¬¬2å…±æŒ¯å³°é¢‘ç‡çš„å·®å€¼å¦‚ä¸‹ï¼š

| å…ƒéŸ³            | ç¬¬ä¸€å…±æŒ¯å³° | ç¬¬äºŒå…±æŒ¯å³° |
| :-------------- | :--------: | :--------: |
| aå‘éŸ³ç”·å¥³çš„å·®å€¼ |    124     |     64     |
| eå‘éŸ³ç”·å¥³çš„å·®å€¼ |     31     |    122     |
| iå‘éŸ³ç”·å¥³çš„å·®å€¼ |     7      |     43     |
| oå‘éŸ³ç”·å¥³çš„å·®å€¼ |     21     |     80     |
| uå‘éŸ³ç”·å¥³çš„å·®å€¼ |     71     |    883     |

ä»ä¸Šè¡¨å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºåŒä¸€ä¸ªå…ƒéŸ³ï¼Œä¸åŒæ€§åˆ«çš„å‘å£°äººåœ¨ç¬¬1å…±æŒ¯å³°é¢‘ç‡çš„å·®å€¼æ§åˆ¶åœ¨200Hzä»¥å†…ï¼Œè€Œç¬¬1å…±æŒ¯å³°é¢‘ç‡çš„å·®å€¼å˜æ¢å¹…åº¦è¾ƒå¤§ã€‚

å¯¹äºåŒä¸€ä¸ªå…ƒéŸ³ï¼Œä¸åŒçš„å‘å£°äººï¼ˆåŒä¸€æ€§åˆ«ï¼‰åœ¨ç¬¬1å…±æŒ¯å³°é¢‘ç‡å’Œç¬¬2å…±æŒ¯å³°é¢‘ç‡çš„ä¸¤å…±æŒ¯å³°çš„æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š

|      å…ƒéŸ³       | ç¬¬ä¸€å…±æŒ¯å³° | ç¬¬äºŒå…±æŒ¯å³° |
| :-------------: | :--------: | :--------: |
| 01å·å‘å£°äººaå‘éŸ³ |    1021    |    2428    |
| 02å·å‘å£°äººaå‘éŸ³ |    1063    |    2947    |
| 03å·å‘å£°äººaå‘éŸ³ |    1098    |    1849    |

ä»ä¸Šè¡¨å¯¹äºåŒä¸€ä¸ªå…ƒéŸ³ï¼Œä¸åŒçš„å‘å£°äººï¼ˆåŒä¸€æ€§åˆ«ï¼‰åœ¨ç¬¬1å…±æŒ¯å³°é¢‘ç‡çš„å·®è·ä¸ä¸Šç‰¹åˆ«æ˜æ˜¾ï¼Œç›¸å·®å¤§çº¦åœ¨40Hzå·¦å³ï¼Œè€Œåœ¨ç¬¬2å…±æŒ¯å³°é¢‘ç‡ä¸Šçš„å·®è·å°±å¾ˆæ˜æ˜¾ã€‚

ä»å›¾3.2ä¸­å¾ˆå®¹æ˜“çœ‹å‡ºå…ƒéŸ³å…·æœ‰æ›´å¤šçš„èƒ½é‡ï¼Œå¹¶ä¸”å®ƒé›†ä¸­åœ¨è¾ƒä½çš„é¢‘ç‡ã€‚æ— å‘è¾…éŸ³çš„èƒ½é‡è¦ä½å¾—å¤šï¼Œå¹¶ä¸”é€šå¸¸ä»¥æ›´é«˜çš„é¢‘ç‡èšç„¦ã€‚ä¸è¡¨è¾¾è¾…éŸ³çš„æƒ…å†µæ˜¯è¿™ä¸¤è€…ä¹‹é—´çš„ä¸œè¥¿ã€‚